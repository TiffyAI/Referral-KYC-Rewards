<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TiffyAI Trust Dashboard</title>
  <style>
    body {
      font-family: 'Orbitron', sans-serif;
      background: #000 url('MintBadgePlaceholder.jpg') no-repeat center center/cover;
      color: #00ffff;
      text-align: center;
      padding: 2rem;
    }

    .glass {
      background: rgba(0, 0, 0, 0.6);
      border-radius: 20px;
      padding: 2rem;
      max-width: 600px;
      margin: auto;
      box-shadow: 0 0 20px #00ffff;
    }

    .stats {
      font-size: 1.3rem;
      margin: 1rem 0;
    }

    button, input[type="file"] {
      background: #00ffff;
      color: #000;
      border: none;
      padding: 10px 20px;
      margin: 5px;
      font-size: 1rem;
      cursor: pointer;
      border-radius: 10px;
      transition: all 0.3s ease;
    }

    button:hover {
      background: #00ddff;
    }

    #trustScore {
      font-size: 2rem;
      margin-bottom: 1rem;
    }

    .locked {
      color: red;
    }
  </style>
</head>
<body>
  <div class="glass">
    <h1>TiffyAI Trust & Referral</h1>
    <div id="trustScore">Trust Score: <span id="scoreValue">0</span>%</div>

    <div class="stats" id="blueKeys">üîµ Blue Keys: 0</div>
    <div class="stats" id="goldKeys">ü•á Gold Keys: 0</div>
    <div class="stats" id="shares">üì£ Shares: 0</div>

    <div class="stats locked" id="trustStatus">‚ö†Ô∏è Your device is not yet trusted</div>

    <button onclick="handleShare()">Share Referral Link</button>
    <button onclick="addBlueKey()">Claim Blue Key</button>

    <hr style="margin: 2rem 0;">

    <button onclick="exportTrustToFile()">üìÅ Backup Trust File</button>
    <input type="file" onchange="importFile(event)" />

    <div id="importStatus" style="margin-top: 1rem;"></div>
  </div>

  <script type="module">
    import {
      getTrustData,
      saveTrustData,
      addBlueKey,
      addShare,
      exportTrustToFile,
      importTrustFromFile
    } from './trust.js';

    function updateUI() {
      const data = getTrustData();

      document.getElementById('scoreValue').innerText = data.trustScore;
      document.getElementById('blueKeys').innerText = `üîµ Blue Keys: ${data.blueKeys}`;
      document.getElementById('goldKeys').innerText = `ü•á Gold Keys: ${data.goldKeys}`;
      document.getElementById('shares').innerText = `üì£ Shares: ${data.shares}`;

      const status = document.getElementById('trustStatus');
      if (data.trustScore >= 50) {
        status.innerText = '‚úÖ Device Trusted';
        status.classList.remove('locked');
        status.classList.add('unlocked');
      } else {
        status.innerText = '‚ö†Ô∏è Your device is not yet trusted';
        status.classList.add('locked');
      }
    }

    window.addBlueKey = () => {
      addBlueKey();
      updateUI();
    };

    window.handleShare = () => {
      addShare();
      updateUI();
      const shareURL = window.location.href + '?ref=' + Math.random().toString(36).substring(7);
      window.open(`https://twitter.com/intent/tweet?text=Join%20TiffyAI!%20Use%20my%20referral%20link:%20${encodeURIComponent(shareURL)}`, '_blank');
    };

    window.exportTrustToFile = exportTrustToFile;

    window.importFile = (e) => {
      const file = e.target.files[0];
      if (!file) return;

      importTrustFromFile(file, (success) => {
        document.getElementById('importStatus').innerText = success ? '‚úÖ Trust file loaded!' : '‚ùå Invalid or corrupted file.';
        updateUI();
      });
    };

    updateUI();
  </script>
</body>
</html>
